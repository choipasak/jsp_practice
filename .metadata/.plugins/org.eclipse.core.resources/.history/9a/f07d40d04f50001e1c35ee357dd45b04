package com.jsp.servlet;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/*
	- 서블릿이란 웹 페이지를 자바 언어로만 구성하는 것입니다.
	즉, jsp 파일을 자바 언어로만 구성하는 것입니다. 
	톰캣을 사용해서 jsp 파일을 자동으로 class로 변환했다면
	지금은 직접 클래스를 생성해서 클래스로 요청을 처리해 보자는 것입니다. -> 이 역할을 하는게 servlet
 */

public class ServletBasic extends HttpServlet{

	//# 서블릿 클래스를 만드는 방법
	//1. HttpServlet 클래스를 상속 받아야 함(Abstract클래스임)
	//Spring을 사용하면 위의 과정을 할 필요가 없음
	//그니까 지금은 사용 안한다는 얘기

	//2. 생성자를 선언 (선택)
	public ServletBasic() {
		System.out.println("페이지 요청이 들어옴!");
		System.out.println("서블릿 객체가 생성됨!!");
	}

	//3. HttpServlet이 제공하는 상속 메서드를 목적에 맞게 오버라이딩(재정의)합니다.
	//클라이언트가 어떠한 요청을 했을 때 서버는 어떠한 처리와 함께 응답을 할 것인가?
	//init(): 객체가 생성될 때 호출, doGet(): 요청이 get방식,
	//doPost(): 요청이 post방식, service(), destroy(): 객체가 소멸되기 전에 호출...

	@Override
	public void init() throws ServletException {
		/*
        - 페이지 요청이 들어왔을 때 처음 실행할 로직을 작성.
        - init()은 컨테이너(서버 프로그램)에 의해 서블릿 객체가 생성될 때
        최초 1회 자동으로 호출됩니다.
        - 객체의 생성자와 비슷한 역할을 수행합니다.
		 */
		System.out.println("init 메서드 호출!");
	}

	@Override
	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		/*
        - 페이지 요청이 들어왔을 때 자동으로 호출.
        - get, post 구분 없이 들어오는 모든 요청과 응답을 관제할 수 있다.
    	- 매개값으로 요청, 응답 내장 객체가 전달됩니다. 
		 */
		
		/*
		 - get: 경로가 노출이 되어도 상관 없는 데이터를 보낼 때 사용
		 form태그 굳이 필요X => a태그로 링크 넣어줄 때 경로가 노출되어 있는 경로를
		 그대로 작성해주면 get을 굳이 사용하지 않아도 된다.
		 보내는 데이터의 양에 제한이 있
		 (왜: 주소창이 최대값으로 받을 수 있는 양이 정해져 있기 때문, 넘으면 짤려서 전송됨)
		 
		 - post: 사용자의 개인정보 등을 보낼 때 사용
		 반드시 form태그 필요
		 보내는 데이터의 양의 제한이 없다.
		 
		
		System.out.println("서비스 메서드가 호출됨!");
		
		//요청 방식이 뭐니
		String method = request.getMethod();
		//요청 URI가 뭐니?
		String uri = request.getRequestURI();
		//요청 파라미터
		String queryString = request.getQueryString();
		//요청을 보낸 IP주소
		String addr = request.getRemoteAddr();
		
		//요청에 관련된 것들은 다 request가 가지고 있다고 생각하면 된다!
		
		System.out.println("===== 값 확인하기 =====");
		System.out.println("method: " + method);
		System.out.println("uri: " + uri);
		System.out.println("queryString: " + queryString);
		System.out.println("addr: " + addr);// (v6)localhost랑 똑같다고 생각하면 된다!
		//요청을 받으면 request가 실제로 받는지를 확인하는 출력문들
		*/
		
		//요청과 함께 전달된 파라미터를 낱개로 얻는 방법
		String account = request.getParameter("account");
		String password = request.getParameter("password");
		String name = request.getParameter("name");
		
		System.out.println("아이디: " + account);
		System.out.println("비밀번호: " + password);
		System.out.println("이름: " + name);
		//이걸 html파일을 만들어서 짜서 전달해 줘야함
		//응답 화면 제작
		//자바 클래스에서 브라우저로 바로 응답을 구현하기 위해서는
		//PrintWriter 객체를 사용합니다.
		//이미 완성되있는 객체를 받아와서 메서드를 호출?사용? 함
		PrintWriter w = response.getWriter();
		//ㄴ> io클래스인데 클래스에서 브라우저로 out한다는 의미
		
		
	}





}
















